---
title: "第六章：正交性和最小二乘法"
date: 2019-08-26T15:58:15+08:00
draft: false
markup: mmark
---

## 内积、长度和正交性
**内积**  
如果u和v是$$R^{n}$$中的向量，则可以将$$u$$和$$v$$作为$$n \times 1$$矩阵，转置矩阵$$u^{T}$$是$$ 1 \times n $$矩阵，且矩阵乘积$$ u^{T}v$$是一个$$1 \times 1$$矩阵，我们将其记为一个不加括号的实数(标量)。数$$u^{T}v$$称为$$u$$和$$v$$的内积，通常记作$$u\cdot v$$

**定理1** 设$$v$$,$$u$$是$$R^{n}$$中的向量,$$c$$是一个数，那么
1. $$ u \cdot v $$ = $$ v \cdot u $$
2. $$(u+v)\cdot w = u \cdot w + v \cdot w$$
3. $$(cu)\cdot v = c(u\cdot v) = u \cdot (cv)$$
4. $$ u \cdot u \ge 0$$, 并且 $$u \times u = 0$$成立的充分必要条件是$$u=0$$

**向量的长度**  
**定义** 向量v的长度（或范数）是非负数$$||v||$$，定义为  
$$||v|| = \sqrt{v \cdot v} = \sqrt{v^{2}_{1} + v^{2}_{2} + ...+v^{2}_{n}} 且 \parallel v \parallel ^{2} = v \cdot v $$  

长度为1的向量称为单位向量，如果把一个非零向量除以其自身的长度，即乘$$ \frac{1}{||v||} $$, 就可以得到一个单位向量，即$$u=\frac{v}{||v||}$$,因为$$u$$的长度是$$(\frac{v}{||v||})||v||$$。这种把向量$$v$$化成单位向量$$u$$的过程，称为向量$$v$$的**单位化**，此时$$u$$和$$v$$方向一致。  

**定义**  $$R^{n}$$中向量$$u$$和$$v$$之间的距离记作$$dist(u,v)$$，表示向量$$u-v$$的长度，即 $$dist(u,v) = ||u-v||$$  

**定义** 如果$$u \cdot v=0$$,则$$R^{n}$$中的两个向量$$u$$和$$v$$是正交的。  

**定理2** 两个向量$$u$$和$$v$$正交的充分必要条件是$$||u+v||^{2}=||u||^{2} + ||v||^{2}$$  
**定理3** 假设$$A$$是$$ m \times n $$矩阵，那么$$A$$的行空间的正交补是$$A$$的零空间。且$$A$$的列空间的正交补是$$A^{T}$$的零空间。  
![正交基线性无关](/linear_algebra/4_summary.png)  

<br>

---

## 正交集
如果集合中的任意两个不同向量都正交，则$$R^{n}$$中的向量集合$$\{u_{1},...,u_{p}\}$$称为正交集

**定理4** 如果$$S={u_{1},...,u_{p}}$$是由$$R^{n}$$中非零向量构成的正交集，那么$$S$$是线性无关集，因此构成$$S$$所生成的子空间的一组基。
> 证 如果$$0=c_{1}u_{1} + ... + c_{p}u_{p}$$对任意数$$c_{1},...,c_{p}$$成立，那么: \\
$$
0=0 \cdot u = (c_{1}u_{1} + c_{2}u_{2} + ... + c_{p}u_{p}) \cdot u_{1} \\
=(c_{1}u_{1}) \cdot u_{1} + (c_{2}u_{2}) \cdot u_{1} + ... + (c_{p}u_{p}) \cdot u_{1} \\
=c_{1}(u_{1} \cdot u_{1}) + c_{2}(u_{2} \cdot u_{1}) + ... + c_{p}(u_{p} \cdot u_{1}) \\ 
=c_{1}(u_{1} \cdot u_{1})
$$

**定义**  $$R^{n}$$中子空间W的一个正交基是$$W$$的一个基，也是正交基。  

**定理5** 假设$$\{u_{1}, ..., u_{p}\}$$是$$R^{n}$$中子空间W的正交基，对W中的每个向量y,线性组合$$y=c_{1}u_{1}+...+c_{p}u_{p}$$中的权可以由$$c_{j} = \frac{y\cdot u_{j}}{u_{j} \cdot u_{j}}(j=1,...,p)$$计算。
> 证 由于是正交集$$\{ u_{1}, ..., u_{p}\}$$: \\
$$
y \cdot u_{1} = (c_{1}u_{1} + c_{2}u_{2} + ... + c_{p}u_{p}) \cdot u_{1} = c_{1}(u_{1} \cdot u_{1})
$$

---

**正交投影**
![正交投影02](/linear_algebra/6-12.png)  
由上图可知 $$y=y^{'} + z$$ 其中 $$y^{'}=\alpha u, \alpha 是一个数，z是一个垂直于u的向量，记为：z=y- \alpha u, \\
那么z和u正交的充分必要条件是：0=(y- \alpha u) \cdot u = y \cdot u - \alpha (u \cdot u) \\
\alpha = \frac{y \cdot u}{u \cdot u} 且 y^{'} = \frac{y \cdot u}{u \cdot u} \cdot u .向量 y^{'} 称为y在u上 \\
的正交投影，向量z称为y垂直于u的分量。
$$

**单位正交基** 集合 $$\{ u_{1},..., u_{p}\}$$是一个单位正交集，如果它是由单位向量构成的正交集，如果W是一个由单位正交集和组成的子空间，\\
那么$$\{u_{1}, ..., u_{p}\}$$是W的单位正交基。

**定理6** 一个$$m \times n$$ 矩阵U具有单位正交列向量的充分必要条件是$$U^{T}U=I$$。

**定理7** 假设U是一个具有单位正交列的$$m \times n$$矩阵，且x 和 y是$$R^{n}$$的向量，那么：\\
$$ 
a. ||Ux|| = ||x||  \\
b. (Ux) \cdot (Uy) = x \cdot y  \\ 
c. (Ux) \cdot (Uy) = 0 的充分必要条件是 x \cdot y = 0
$$

---

<br>

## 正交投影
**定理8** $$若W是R^{n}的一个子空间，那么R^{n}中每一个向量y可以唯一表示： \\
y = y^{'} + z    \\
此处y^{'}属于W且z属于W^{T},实际上，如果\{u_{1},...,u_{p}\}是W的任意正交基，那么  \\
y^{'} = \frac{y \cdot u_{1}}{u_{1} \cdot u_{1}} \cdot u_{1} + ... + \frac{y \cdot u_{p}}{u_{p} \cdot u_{p}} \cdot u_{p} \\
且 z = y - y^{'}, 其中y^{'}是y在W上的正交投影
$$
![正交投影03](/linear_algebra/6-19.png) 


**定理9** $$假设W是R^{n}空间中的一个子空间，y是R^{n}中的任意向量，y^{'}是y在W上的正交投影，那么y^{'}是W中最接近y的点，\\
也就是指||y-y^{'}|| < ||y - v||对所有属于W又异于y^{'}的v成立$$ 

**定理10** $$如果\{u_{1}, ..., u_{p}\}是R^{n}中子空间W的正交基，那么 \\
projy = (y_{1} \cdot u_{1}) \cdot u_{1} + ...+(y_{1} \cdot u_{p}) \cdot u_{p} \\
如果U=[u_{1} u_{2} ... u_{p}],则  \\
projy = UU^{T}y,对所有y \in R^{n}成立
$$

---

<br>

## 格拉姆-施密特方法
**定理11** $$R^{n}中子空间的一个基\{x_{1}, ..., x_{p}\}，定义 \\
v_{1} = x_{1} \\
v_{2} = x_{2} - \frac{x_{2} \cdot v_{1}}{v_{1} \cdot v_{1}} v_{1}  \\
... \\
v_{p} = x_{p} - \frac{x_{p} \cdot v_{1}}{v_{1} \cdot v_{1}} v_{1} - ... - \frac{x_{p} \cdot v_{p-1}}{v_{p-1} \cdot v_{p-1}} v_{p-1} \\
那么 \{v_{1}, ..., v_{p}\}是W的一个正交基，此外 \\
Span\{v_{1}, ..., v_{k}\} = Span\{x_{1}, ..., x_{k}\}
$$

> 例子 $$设 x_{1}=\begin{bmatrix}1 \\ 1 \\1 \\1  \end{bmatrix},x_{2}=\begin{bmatrix}0 \\ 1 \\1 \\1  \end{bmatrix},x_{3}=\begin{bmatrix}0 \\ 0 \\1 \\1  \end{bmatrix},那么\{x_{1},x_{2},x_{3}\}显然线性无关，\\ 
且构成R^{4}中子空间W的一个基，试构造W的一个正交基 \\
解 步骤1 取v_{1}=x_{1} 和 W_{1}=Span\{x_{1}\}=Span\{v_{1}\}. \\
步骤2 取 v_{2}是x_{2}减去它在子空间W_{1}上投影所得到的向量，即
v_{2} = x_{1} - projx_{1}=x_{2} - \frac{x_{2} \cdot v_{1}}{v_{1} \cdot v_{1}} v_{1} \\ 
=\begin{bmatrix}0 \\ 1 \\1 \\1  \end{bmatrix} - 3/4\begin{bmatrix}1 \\ 1 \\1 \\1  \end{bmatrix} = \begin{bmatrix}-3/4 \\ 1/4 \\1/4 \\1/4  \end{bmatrix} \\
为了方便重新度量向量v_{2}, v_{2} = \begin{bmatrix}-3 \\ 1 \\1 \\1  \end{bmatrix} \\
步骤3 取v_{3}是x_{3}减去它在子空间W_{2}上的投影所产生的向量，先利用正交基\{v_{1},v_{2}\}计算x_{3}在W_{2}上的投影， \\
projx_{3} = \frac{x_{3} \cdot v_{1}}{v_{1} \cdot v_{1}} v_{1} + \frac{x_{3} \cdot v_{2}}{v_{2} \cdot v_{2}} v_{2} = \begin{bmatrix}0 \\ 2/3 \\2/3\\2/3  \end{bmatrix} \\ 
v_{3} = x_{3} - projx_{3} = \begin{bmatrix}0 \\ -2/3 \\1/3 \\1/3  \end{bmatrix}
$$

---

**定理12** QR分解$$若果 m \times n 矩阵A的列线性无关，那么A可以分解为A=QR,其中Q是一个 m \times n 矩阵，\\
其列形成ColA的一个标准正交基，R是一个 n \times n 上三角可逆矩阵且在对角线上的元素为正数。$$
> 例子： $$求A=\begin{bmatrix}1 & 0 & 0 \\ 1 & 1 &0 \\ 1 & 1 &1 \\ 1 & 1 &1 \end{bmatrix}的一个QR分解。 \\
求得正交基是v1= \begin{bmatrix}1 \\ 1 \\ 1 \\ 1 \end{bmatrix},v2= \begin{bmatrix}-3 \\ 1 \\ 1 \\ 1 \end{bmatrix},v3= \begin{bmatrix}0 \\ -2/3 \\ 1/3 \\ 1/3 \end{bmatrix} \\
重新度量上面三个向量，将它们单位话后组成Q得到：\\
Q=\begin{bmatrix}1/2 & -3/\sqrt{12} & 0 \\ 1/2 & 1/\sqrt{12} & -2/\sqrt{6}\\ 1/2 & 1/\sqrt{12} & 1/\sqrt{6} \\ 1/2 & 1/\sqrt{12} & 1/\sqrt{6}\end{bmatrix} \\
由Q^{T}A = Q^{T}(QR) = IR = R得到 \\
R = Q^{T}A = \begin{bmatrix}2 & 3/2 & 1 \\ 0 & 3/\sqrt{12} & 2/\sqrt{12}\\ 0 & 0 & 2/\sqrt{6} \end{bmatrix}
$$

---

<br>

## 最小二乘法
加入Ax=b是一个不存在解的方程组，那么可以考虑Ax到b的一个近似，距离越小越好，最小二乘法就是找到 Ax到b的最小距离。


**定义** 如果$$m \times n 矩阵A和向量b属于R^{m},Ax=b的最小 二乘解是R^{n}中的x^{'},使得 \\ 
||b - Ax^{'}|| \le ||b -Ax||$$

**定理13** 方程Ax=b的最小二乘法解集和方程法$$A^{T}Ax=A^{T}b$$的非空解集一致。

**定理14** 矩阵$$A^{T}A$$是可逆的充分必要条件是:A的列线性无关，在这种情形下，方程Ax=b有唯一最小二乘法解$$x^{'}$$且它有下面的表示 
$$x^{'} = (A^{T}A)^{-1}A^{T}b$$

**定理15** 给定一个矩阵$$m \times n $$矩阵A，且具有线性无关的列，取 $$A=QR$$是A类似定理12的分解其解为$$x^{'}=R^{-1}Q^{T}b$$